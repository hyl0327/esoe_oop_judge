{% extends 'judge/base.html' %}

{% load staticfiles %}
{% load widget_tweaks %}

{% block css %}
<link rel="stylesheet" href="{% static 'judge/css/profile.css' %}">
{% endblock %}

{% block content %}
<div id="content_div">
  <h2>{{ profile.user.username }} ({{ profile.user.first_name }})</h2>

  <h3>Bitbucket Settings & Change Password</h3>
  <form method="post" action="{% url 'judge:profile' %}">
    {% csrf_token %}

    <div id="bitbucket_div">
      {# default class : "errorlist nonfield" #}
      {{ update_bitbucket_form.non_field_errors }}
      {% for field in update_bitbucket_form %}
      <div class="sub_bitbucket_div">
        {# default class: "errorlist" #}
        {{ field.errors }}
        <label for="{{ field.id_for_label }}" class="bitbucket_label">{{ field.label }}</label>
        {{ field|add_class:"bitbucket_field" }}
      </div>
      {% endfor %}
    </div>

    <div id="password_div">
      {{ password_change_form.non_field_errors }}
      {% for field in password_change_form %}
      <div class="sub_password_div"> 
        {{ field.errors }}
        <label for="{{ field.id_for_label }}" class="password_label">{{ field.label }}</label>
        {{ field|add_class:"password_field" }}
      </div>
      {% endfor %}
    </div>

    <input type="submit" value="Update" id="update_btn">
  </form>

  <div id="submissions_div">
    <h3>My Submissions</h3>

    <table id="submissions_table">
      <thead>
        <tr>
          <th class="submissions_id">ID</th>
          <th class="submissions_problem">Problem</th>
          <th class="submissions_status">Status</th>
          <th class="submissions_score">Score</th>
          <th class="submissions_runningtime">Running Time</th>
          <th class="submissions_datetime">Submission Datetime</th>
        </tr>
      </thead>
      <tbody>
        {% for submission in profile.submission_set.all %}
        <tr>
          <td>{{ submission.pk }}</td>
          <td><a href="{% url 'judge:problem_detail' submission.problem.pk %}">{{ submission.problem }}</a></td >
          <td>{{ submission.get_status_display }}</td>
          <td>{{ submission.score }} / {{ submission.problem.testcase_amount }}</td>
          <td>{{ submission.running_time }} ms</td>
          <td>{{ submission.submission_datetime }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
